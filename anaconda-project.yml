name: jupyter-graphql-dev

variables:
  PY_SRC: src setup.py

commands:
  lab:
    unix: jupyter lab --no-browser --debug
  setup:
    unix: pip install -e . --ignore-installed --no-deps
  lint:
    unix: set -eux && isort -rc $PY_SRC && black $PY_SRC && jlpm lint
  lab:down:
    unix: |-
      set -eux \
      && rm -rf \
        $CONDA_PREFIX/share/jupyter/lab \
        ./node_modules \
      && jlpm cache clean
  lab:hack:
    unix: cd $CONDA_PREFIX/share/jupyter/lab/staging && jlpm
  atom:
    unix: atom .
  static:
    unix: python -m jupyter_graphql.fetch_static

env_specs:
  default:
    inherit_from:
      - jupyter-graphql-dev
    platforms:
      - linux-64
      - osx-64
      - win-64
    packages:
      - black
      - flake8
      - beautysh
      - isort
  jupyter-graphql-dev:
    packages:
      - gql
      - graphene
      - iso8601
      - jupyterlab >=0.35,<0.36
      - nodejs >=8,<9
      - pandas
      - pyld
      - python >=3.6,<3.7
      - rdflib-jsonld
      - requests
      - requests-cache
      - werkzeug
      - pip:
          - graphql-ws
          - graphene-tornado
    channels:
      - conda-forge
      - defaults
      - bioconda
